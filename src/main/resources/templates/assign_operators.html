<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments :: head">
    <title>Assign Operators</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div th:replace="fragments :: nav"></div>

<div class="container my-5">
    <h1 class="mb-4 text-center text-primary" th:text="'Assign operators to request #' + ${request.id}"></h1>
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <p class="mb-1"><strong>User:</strong> <span th:text="${request.username}"></span></p>
            <p><strong>Course:</strong> <span th:text="${request.course != null ? request.course.name : ''}"></span></p>
        </div>
    </div>

    <form th:action="@{|/requests/${request.id}/assign|}" method="post" class="mb-4">
        <div class="list-group mb-3" th:each="op : ${operators}">
            <label class="list-group-item d-flex align-items-center">
                <input class="form-check-input me-2" type="checkbox" name="operatorIds" th:value="${op.id}"
                       th:checked="${#lists.contains(request.operators, op)}"/>
                <span th:text="${op.name + ' ' + op.surname + ' (' + op.department + ')'}"></span>
            </label>
        </div>
        <button type="submit" class="btn btn-success w-100">Assign</button>
    </form>

    <h3 class="mb-3 text-secondary">Currently assigned</h3>
    <ul class="list-group mb-4">
        <li class="list-group-item" th:each="op : ${request.operators}" th:text="${op.name + ' ' + op.surname}"></li>
    </ul>

    <form th:action="@{|/requests/${request.id}/handle|}" method="post">
        <button type="submit" class="btn btn-primary w-100" th:disabled="${!request.handled}">Mark handled</button>
    </form>
</div>

<div th:replace="fragments :: footer"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>